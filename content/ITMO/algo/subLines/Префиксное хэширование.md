#itmo
## Введение

Префиксное хэширование — это мощный метод, используемый в алгоритмах и структурах данных для ускорения различных вычислений и обработки строк. Этот метод широко применяется в задачах, связанных с обработкой текстов, таких как поиск подстрок, сравнение строк и другие. В данной статье мы рассмотрим основные концепции, применение и реализацию префиксного хэширования.

## Основные Концепции

### Префикс

Префиксом строки $S$ называется любая её начальная подстрока. Например, для строки "алгоритм", префиксы включают "", "а", "ал", "алг", и так далее до самой строки "алгоритм".

### Хэширование

Хэширование — это процесс преобразования данных в фиксированный размер, обычно в виде числового значения. Хэш-функция $h$ принимает строку $S$ и возвращает целое число $h(S)$. Хорошая хэш-функция должна распределять значения равномерно и минимизировать количество коллизий (случаи, когда разные строки имеют одинаковый хэш).

### Префиксное Хэширование

Префиксное хэширование — это техника, где для каждого префикса строки вычисляется хэш, что позволяет быстро вычислять хэши подстрок. Это достигается путем предварительного вычисления хэшей всех префиксов строки.

## Применение Префиксного Хэширования

### Поиск Подстрок

Одной из ключевых областей применения префиксного хэширования является задача поиска подстрок. Например, чтобы найти все вхождения подстроки $T$ в строку $S$, можно вычислить хэш $T$ и сравнивать его с хэшами подстрок $S$ соответствующей длины.

### Сравнение Подстрок

Префиксное хэширование позволяет быстро сравнивать подстроки строки. Если нужно узнать, равны ли подстроки $S[i:j]$ и $S[k:l]$, достаточно сравнить их хэши.

## Реализация Префиксного Хэширования

### Алгоритм

Рассмотрим строку $S$ длины $n$ и хэш-функцию $h$. Основная идея префиксного хэширования заключается в следующем:

1. Вычислить хэши всех префиксов строки $S$.
2. Для каждой подстроки можно вычислить её хэш с использованием хэшей префиксов.

### Вычисление Хэшей Префиксов

Для строки $S$ длины $n$ вычислим массив хэшей префиксов $H$, где $H[i]$ — хэш префикса $S[0:i-1]$. Это можно сделать за линейное время:

$$
H[i] = (H[i-1] \cdot p + S[i-1]) \mod m
$$

где:
- $p$ — некоторое простое число (например, 31 или 37),
- $m$ — модуль (обычно большое простое число).

Изначально $H[0] = 0$.

### Вычисление Хэша Подстроки

Хэш подстроки $S[l:r]$ можно вычислить за $O(1)$ времени с использованием предвычисленных хэшей префиксов:

$$
h(S[l:r]) = (H[r] - H[l] \cdot p^{r-l} \mod m + m) \mod m
$$

где $p^{r-l}$ можно предварительно вычислить и хранить.

### Пример Реализации на Python

```python
def compute_prefix_hashes(S, p=31, m=10**9+7):
    n = len(S)
    H = [0] * (n + 1)
    p_powers = [1] * (n + 1)
    
    for i in range(1, n + 1):
        H[i] = (H[i-1] * p + ord(S[i-1])) % m
        p_powers[i] = (p_powers[i-1] * p) % m
        
    return H, p_powers

def substring_hash(H, p_powers, l, r, m=10**9+7):
    return (H[r] - H[l] * p_powers[r-l] % m + m) % m

# Пример использования
S = "алгоритм"
H, p_powers = compute_prefix_hashes(S)
hash_substring = substring_hash(H, p_powers, 2, 5)  # Хэш подстроки "гор"
print(hash_substring)
```

## Заключение

Префиксное хэширование — это мощная техника, которая позволяет эффективно решать задачи, связанные с обработкой строк. Предварительное вычисление хэшей префиксов позволяет быстро находить и сравнивать подстроки, что делает этот метод полезным в различных алгоритмических задачах.

### Преимущества

- **Эффективность:** Позволяет вычислять хэши подстрок за $O(1)$ время после предвычислений.
- **Гибкость:** Может использоваться в различных задачах, связанных с обработкой текстов.

### Ограничения

- **Проблема коллизий:** Возможны коллизии хэшей, которые могут требовать дополнительных проверок.
- **Выбор параметров:** Требуется тщательный выбор параметров $p$ и $m$ для минимизации коллизий и оптимизации работы.

Префиксное хэширование — это один из фундаментальных методов, который стоит изучить каждому, кто работает с алгоритмами и структурами данных, особенно в контексте обработки строк и текстов.