#  Регистр EDI: Основы и Применение в Ассемблере

##  Введение

Регистр EDI (Extended Destination Index) — один из регистров общего назначения в архитектуре x86 процессоров Intel. Он играет важную роль в операциях работы с памятью, особенно при манипуляции строками и массивами. В этой статье мы рассмотрим функции регистра EDI, его использование в программировании на ассемблере, а также примеры кода, демонстрирующие его применение.

##  Основы регистра EDI

Регистр EDI является 32-битным регистром, который используется для указания на адреса в памяти, служа в качестве индекса для операций с массивами и строками. В 64-битной архитектуре (x86-64) его расширенная версия называется RDI.

###  Подрегистры EDI:

- **EDI (32 бита)**: Полный 32-битный регистр.
- **DI (16 бит)**: Нижняя половина регистра EDI.
- **DIL (8 бит)**: Нижний байт регистра DI.

##  Основные функции регистра EDI

1. **Операции с памятью**: EDI используется в качестве указателя на адрес в памяти для операций копирования, сравнения и обработки строк.
2. **Системные вызовы**: В некоторых соглашениях о вызовах регистр EDI используется для передачи аргументов функций.
3. **Работа с массивами**: EDI часто применяется для итерации по элементам массивов, особенно в сочетании с командами `lods`, `stos`, `movs` и `scas`.

##  Примеры использования регистра EDI

###  Операции со строками и массивами

Команды `lods`, `stos`, `movs` и `scas` специально разработаны для работы с массивами и строками, используя регистры EDI и ESI (Source Index).

**Пример: Копирование строки с использованием `movs`**:
```assembly
section .data
    source db 'Hello, world!', 0   ; Исходная строка
    destination times 13 db 0      ; Память для копирования строки

section .text
    global _start

_start:
    mov esi, source    ; Установить ESI на начало исходной строки
    mov edi, destination ; Установить EDI на начало целевой строки
    mov ecx, 13        ; Установить ECX на длину строки

    cld                ; Установить направление строки вперед
    rep movsb          ; Копировать байты из [ESI] в [EDI]

    ; Завершение программы
    mov eax, 60        ; Системный вызов для завершения программы (sys_exit)
    xor edi, edi       ; Код завершения 0
    syscall            ; Вызвать системный вызов
```

###  Сравнение строк с использованием `scas`:

**Пример: Поиск символа в строке**:
```assembly
section .data
    str db 'Hello, world!', 0   ; Строка для поиска
    char db 'w'                 ; Символ для поиска

section .text
    global _start

_start:
    mov edi, str        ; Установить EDI на начало строки
    mov al, [char]      ; Загрузить символ для поиска в AL
    mov ecx, 13         ; Установить ECX на длину строки

    cld                 ; Установить направление строки вперед
    repne scasb         ; Искомый байт в AL сравнить с байтом по [EDI]

    jz found            ; Перейти к метке found, если символ найден
    jmp not_found       ; Перейти к метке not_found, если символ не найден

found:
    ; Код для обработки найденного символа
    jmp done

not_found:
    ; Код для обработки ненайденного символа

done:
    ; Завершение программы
    mov eax, 60        ; Системный вызов для завершения программы (sys_exit)
    xor edi, edi       ; Код завершения 0
    syscall            ; Вызвать системный вызов
```

##  Заключение

Регистр EDI является важным элементом в программировании на ассемблере, особенно при работе с памятью, строками и массивами. Он предоставляет удобный способ указания на адреса в памяти и служит для выполнения операций копирования, сравнения и обработки данных. Понимание и эффективное использование регистра EDI помогает разработчикам создавать более оптимизированный и производительный код на ассемблере.